<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <pre>
        Promise.all静态方法    
        概念:合并多个Promise对象,等待所有同时成功完成(或某一个失败),做后续逻辑


    </pre>
    <img src="../imgs/静态方法.svg" alt="">
    <pre>
        语法:
        const p = Promise.all([Promise对象,Promise对象,...])   
        p.then(result=>{
            //result结果:[Promise对象成功结果,Promise对象成功结果,...]
        }).catch(error=>{
            //第一个失败的Promise对象,抛出异常
        })

        需求:同时请求"北京","上海","广州","深圳"的天气并在网页尽可能同时显示!!
    </pre>
    <ul></ul>
    <script src="axios.min.js"></script>
    <script>
    /**
     * 目标：掌握Promise的all方法作用，和使用场景
     * 业务：当我需要同一时间显示多个请求的结果时，就要把多请求合并
     * 例如：默认显示"北京", "上海", "广州", "深圳"的天气在首页查看
     * code：
     * 北京-110100
     * 上海-310100
     * 广州-440100
     * 深圳-440300
    */
   //1.请求城市的天气得到Promise对象  
        const bjPromise = axios({url:'https://hmajax.itheima.net/api/weather',method:'get',params:{
            city:'110100'
        }})
        const shPromise = axios({url:'https://hmajax.itheima.net/api/weather',method:'get',params:{
            city:'310100'
        }})
        const gzPromise = axios({url:'https://hmajax.itheima.net/api/weather',method:'get',params:{
            city:'440100'
        }})
         const szPromise = axios({url:'https://hmajax.itheima.net/api/weather',method:'get',params:{
            city:'440300'
        }})

        szPromise.then(result=>{
            console.log(result)
        })
    
    // 使用Promise.all,合并多个Promise对象   
        const p = Promise.all([bjPromise,shPromise,gzPromise,szPromise])  
        p.then(result=>{
            console.log(result)
            const htmlStr = result.map(item=>{
                return `
                    <li>${item.data.data.area} --- ${item.data.data.weather}</li>
                `
            }
            
        ).join(' ')
        document.querySelector('ul').innerHTML = htmlStr
        }).catch(error=>{
            console.dir(error)
        })

    </script>
</body>
</html>